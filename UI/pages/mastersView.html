<!DOCTYPE html>
<!-- saved from url=(0128)https://www.pixinvent.com/demo/frest-clean-bootstrap-admin-dashboard-template/html/ltr/horizontal-menu-template/form-layout.html -->
<html class="loaded" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="Frest admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, Frest admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>View Master Data</title>
    <link rel="apple-touch-icon" href="https://www.pixinvent.com/demo/frest-clean-bootstrap-admin-dashboard-template/app-assets/images/ico/apple-icon-120.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://www.pixinvent.com/demo/frest-clean-bootstrap-admin-dashboard-template/app-assets/images/ico/favicon.ico">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet " type="text/css " href="../../css/vendors.min.css ">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet " type="text/css " href="../../css/bootstrap.min.css">
    <link rel="stylesheet " type="text/css " href="../../css/bootstrap-extended.min.css ">
    <link rel="stylesheet " type="text/css " href="../../css/colors.min.css ">
    <link rel="stylesheet " type="text/css " href="../../css/components.min.css ">
    <link rel="stylesheet " type="text/css " href="../../css/dark-layout.min.css ">
    <link rel="stylesheet " type="text/css " href="../../css/semi-dark-layout.min.css ">
    <!-- END: Theme CSS-->

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet " type="text/css " href="../../css/horizontal-menu.min.css ">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet " type="text/css " href="../../css/style.css ">
    <!-- END: Custom CSS-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons " rel="stylesheet ">

    <link rel="apple-touch-icon " href="../../app-assets/images/ico/apple-icon-120.png ">
    <link rel="shortcut icon " type="image/x-icon " href="../../app-assets/images/ico/favicon.ico ">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600%7CIBM+Plex+Sans:300,400,500,600,700 " rel="stylesheet ">


    <link rel="stylesheet " type="text/css " href="../../app-assets/vendors/css/vendors.min.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/vendors/css/charts/apexcharts.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/vendors/css/extensions/swiper.min.css ">
    <link rel="stylesheet " href="../../css/font-awesome-4.7.0/css/font-awesome.min.css ">



    <link rel="stylesheet " type="text/css " href="../../app-assets/css/bootstrap.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/css/bootstrap-extended.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/css/colors.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/css/components.css ">


    <link rel="stylesheet " type="text/css " href="../../app-assets/css/core/menu/menu-types/horizontal-menu.css ">
    <link rel="stylesheet " type="text/css " href="../../app-assets/css/pages/dashboard-ecommerce.css ">





    <link rel="icon " href="../../img/core-img/favicon.png " />


    <link rel="stylesheet " href="../../css/responsive.css " />

    <link rel="stylesheet " type="text/css " href="../../css/custom.css " />


    <script src="../../js/modernizr.js "></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-analytics.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyAaX52IZbaEg3gYnMeHRWh5bi-pLEw2-c4",
            authDomain: "sanathana-1558e.firebaseapp.com",
            projectId: "sanathana-1558e",
            storageBucket: "sanathana-1558e.appspot.com",
            messagingSenderId: "69696836774",
            appId: "1:69696836774:web:4edf184e3cfe3608679067",
            measurementId: "G-DRHZRFBMLY"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>




</head>
<!-- END: Head-->

<style>
    body {
        font-family: Arial, Helvetica, sans-serif;
    }
    /* The Modal (background) */
    
    .modal {
        display: none;
        /* Hidden by default */
        position: fixed;
        /* Stay in place */
        z-index: 1;
        /* Sit on top */
        padding-top: 100px;
        /* Location of the box */
        left: 0;
        top: 0;
        width: 100%;
        /* Full width */
        height: 100%;
        /* Full height */
        /* Enable scroll if needed */
        background-color: rgb(0, 0, 0);
        /* Fallback color */
        background-color: rgba(0, 0, 0, 0.4);
        /* Black w/ opacity */
    }
    /* Modal Content */
    
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        height: 100%;
    }
    /* The Close Button */
    
    .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }
    
    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }
    .active{
        display: block;
    }
    .inactive{
        display: none;
    }
    .row{
        margin: 0px !important;
    }
</style>

<!-- BEGIN: Body-->

<body style="background-color:  #d4d4d473;">

    <div id="navbar-container">

    </div>
    <div class=" row p-1" style="position: fixed;bottom:0;z-index: 999999;">
        <div class="col toast-container">
            
        </div>
      </div>
    <div class=" row p-1" style="position: fixed;bottom:0;z-index: 999999;">
        <div class="col toast-container">
            
        </div>
    </div>
    <div class="container" style="padding-top: 10%;">
        <div class="row  p-2">
            <div class="col">

            </div>
            <div class="col">
                <h2 class="list-heading text-center primary text-bold-500 text-capitalize"></h2>
            </div>
            <div class="col text-right">
                <a href="javascript:void(0)" class="btn btn-danger new-btn">New <i class="bx bx-plus"></i></a>
            </div>
        </div>

        <div class="row justify-content-between px-4 data-cards">
            
        </div>
    </div>

    <script src="../../js/jquery-2.2.4.min.js "></script>

    <script src="../../js/headroom.js"></script>

    <script src="../../js/popper.min.js"></script>

    <script src="../../js/bootstrap.min.js"></script>

    <script src="../../js/plugins.js"></script>

    <script src="../../js/active.js"></script>

    <script src="../../js/jquery.mobile.custom.min.js "></script>

    <script src="../../js/main.js "></script>

    <script src="../../app-assets/vendors/js/vendors.min.js "></script>
    

    <script src="../../app-assets/vendors/js/ui/jquery.sticky.js "></script>

    <script src="../../app-assets/js/scripts/configs/horizontal-menu.js "></script>
    <script src="../../app-assets/js/core/app-menu.js "></script>
    <script src="../../app-assets/js/core/app.js "></script>
    <script src="../../app-assets/js/scripts/components.js "></script>
    <script src="../../app-assets/js/scripts/footer.js "></script>
    <script src="../../js/globalFuntions.js"></script>
    <!-- <script src="../../app-assets/js/scripts/pages/bootstrap-toast.min.js"></script> -->

    <script>
        $('#navbar-container').load('../components/navbar.html');
        $(document).ready(function() {
            var year = new Date().getFullYear();
            $(".year").text(year);
                         // grab an element
            var myElement = document.querySelector("header");
            // construct an instance of Headroom, passing the element
            var headroom = new Headroom(myElement);
            // initialise
            headroom.init();
        });

        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>     
<script>
var myHeaders = new Headers();
// myHeaders.append("Content-Type ", "text/plain ");
// myHeaders.append("Cookie ", "PHPSESSID=a147dbe2815c8b7145c6f2ca214f3716 "); 
var id;
var parentId;
const params = (new URL(document.location)).searchParams;
if(params.get('id')){
    id = params.get('id');
    if(params.get('parentId')){
        parentId = params.get('parentId');
    }
}else{
    window.location = "./main.html";
}
  function adminRedirect(){
    var userData = {};
    var authRequestOptions = {
    method : "POST",
    redirect : "follow",
    headers : myHeaders,
    body : ""
    }
    fetch("../../ws/auth.php",authRequestOptions)
    .then(response => response.json())
    .then(result => {
    console.log(result);
    if(result.status === "Not Logged In"){
        //redirect to login screen
        window.open("./login.html","_self");
    }else{
            if(result.admin == "0"){
                window.open("./dashBoard.html","_self");
            }
    }
    })
    .catch(error =>{console.log(error);});
  }
  


auth();
adminRedirect();
showData();

function showData(){
    document.querySelector('.list-heading').textContent = id;
    document.querySelector('.new-btn').addEventListener('click',()=>{
        openAddForm(0,"add");
    })
    console.log(id);
    var data = {
        load : "loadbyparent",
        id : id
    }
    data = JSON.stringify(data);
    var requestOption = { method: 'POST', headers: myHeaders,redirect: 'follow',body : data};
    fetch("../../ws/Accessconfig.php",requestOption)
    .then(response => response.json())
    .then(result => {
        console.log(result);
        if(Array.isArray(result)){
            var html = "";
            result.forEach(item =>{
                var activeClass = "";
                var inactiveClass = "";
                if(item.status == "1"){
                    activeClass = "active";
                    inactiveClass = "inactive";
                }else{
                    activeClass = "inactive";
                    inactiveClass = "active";
                }
                html += `<div class="col-md-5 card">
                    <div class="row card-header justify-content-between">
                        <div class="col chip chip-primary">
                            <div class="row chip-body ">
                                <span class="chip-text text-center" style="font-size : 1.2rem;padding : 0.4rem">
                                    `+item.ContentName+`
                                </span>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row justify-content-around">
                                <a href="javascript:void(0)" onclick="openAddForm('`+item.ContentName+`','update')">
                                    <div class="livicon-evo" data-options=" name: pen.svg; size: 3rem "></div>
                                </a>
                                <div class="active-status" style="position: relative;">
                                    <a href="javascript:void(0)" id="active-`+item.ContentName+`" style="position: relative;" class="`+activeClass+`" onclick="changeStatus('`+item.ContentName+`',0)">
                                        <div class="livicon-evo" data-options=" name: like.svg; size: 3rem "></div>
                                    </a>
                                    <a href="javascript:void(0)" id="inactive-`+item.ContentName+`" style="position: relative;" class="`+inactiveClass+`" onclick="changeStatus('`+item.ContentName+`',1)">
                                        <div class="livicon-evo" data-options=" name: like.svg; style: solid; size: 3rem; flipVertical: true "></div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            document.querySelector('.data-cards').innerHTML = html;

        }
    })
    .then(()=>{
        loadScripts();
    })
    .catch(error =>{console.log(error);});
}
function changeStatus(id,status){
    console.log(status);
    console.log("changing-status");
    var activeTarget = `active-`+id+``;
    var inactiveTarget = `inactive-`+id+``;
    var activeClassList = document.getElementById(activeTarget).classList;
    var inActiveClassList = document.getElementById(inactiveTarget).classList;
    if(status == 1){
        if(activeClassList.contains("inactive")){
            console.log("status is active");
            activeClassList.remove("inactive");
            activeClassList.add("active");
        }
        if(inActiveClassList.contains("active")){
            console.log("status is active");
            inActiveClassList.remove("active");
            inActiveClassList.add("inactive");
        }
    }else if(status == 0){
        if(activeClassList.contains("active")){
        console.log("status is inactive");

            activeClassList.remove("active");
            activeClassList.add("inactive");
        }
        if(inActiveClassList.contains("inactive")){
        console.log("status is inactive");

            inActiveClassList.remove("inactive");
            inActiveClassList.add("active");
        }
    }

    // updating status
    // fetch data
    var fetchFormBody = {
        load : "loadbyname",
        id : id
    }
    fetchFormBody = JSON.stringify(fetchFormBody);
    var fetchFormRequestOptions = {
        method : "POST",
        headers : myHeaders,
        redirect : "follow",
        body : fetchFormBody
    }
    fetch("../../ws/Accessconfig.php",fetchFormRequestOptions)
    .then( response => response.json())
    .then( result =>{
        console.log(result);
        var formValues = result[0];
        var data = {
            load : "update",
            Alias_Name: formValues.Alias_Name,
            ContentName: formValues.ContentName,
            access_to: formValues.access_to,
            content: formValues.content,
            createdby: formValues.createdby,
            createddate: formValues.createddate,
            header: formValues.header,
            iconpath: formValues.iconpath,
            id: formValues.id,
            imagepath: formValues.imagepath,
            parent_id: formValues.parent_id,
            status: status,
            updatedby: formValues.updatedby,
            updateddate: formValues.updateddate,
            urlredirection: formValues.urlredirection,
            videopath: formValues.videopath,
            emptystateimg : formValues.emptystateimg
        };
        data = JSON.stringify(data);
        console.log(data);
        var updateRequestOptions = {
            headers : myHeaders,
            method : "POST",
            redirect : "follow",
            body : data
        }
        fetch("../../ws/Accessconfig.php", updateRequestOptions)
        .then(response => response.json())
        .then(response =>{
            console.log(response);
            if(response.status == "Updated Succesfully"){
                if(status == 0){
                    toast("Updated status",'bg-warning');
                    auth();
                }else{
                    toast("Updated status",'bg-success');
                    auth();
                }
            }else{
                 toast("Unable to update status",'bg-danger');  
            }
        })
        .catch(error =>{
            console.log(error);
            toast("Unable to update status",'bg-danger');
        })
    })
    .catch( error =>{
        console.log(error);
        toast("Unable to update status",'bg-danger');
    })
    //get object ready
    //send data back

}
function openAddForm(selfid,action){
    if(action == "add"){
        window.location = `./mastersAdd.html?id=`+id+`&action=add&parentId=`+parentId+``;
    }else{
        window.location = `./mastersAdd.html?id=`+selfid+`&action=update`;
    }
}
function loadScripts(){
    var locations = ["LivIconsEvo.tools.js","LivIconsEvo.defaults.js","LivIconsEvo.min.js"];
    locations.forEach(location =>{
        var script = document.createElement('script');
        script.src = `../../app-assets/fonts/LivIconsEvo/js/`+location;
        var ref = document.querySelector('body');
        ref.appendChild(script);
    });
}
loadScripts();
</script>

</body>
</html>
